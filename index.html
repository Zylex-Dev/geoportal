<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Геопортал объектов черной металлургии Челябинской области</title>
    <link rel="stylesheet" href="css/fonts.css">
    <link rel="stylesheet" href="fontawesome/css/all.min.css">
    <link rel="stylesheet" href="lib/bootstrap/bootstrap.min.css">
    <link rel="stylesheet" href="lib/ol/ol.css">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="icon" type="image/png" href="img/favicon.png">
</head>

<body>
    <header class="py-3">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <div class="d-flex align-items-center">
                        <div class="logo-container me-3">
                            <i class="fas fa-map-marked-alt fa-2x text-white"></i>
                        </div>
                        <div>
                            <h1 class="text-light">Геопортал объектов черной металлургии</h1>
                            <p class="lead mb-0">Челябинская область</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 text-end">
                    <div id="auth-buttons">
                        <button class="btn btn-outline-light me-2" id="login-btn">
                            <i class="fas fa-sign-in-alt me-1"></i> Войти
                        </button>
                        <button class="btn btn-outline-light" id="about-btn">
                            <i class="fas fa-info-circle me-1"></i> О проекте
                        </button>
                    </div>
                    <div id="user-profile" class="d-none">
                        <span class="text-white me-2">Вы вошли как: <strong id="user-display-name"></strong></span>
                        <button class="btn btn-danger btn-sm" id="logout-btn">
                            <i class="fas fa-sign-out-alt me-1"></i> Выйти
                        </button>
                        <button class="btn btn-outline-light ms-2" id="about-btn-logged">
                            <i class="fas fa-info-circle me-1"></i> О проекте
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main class="container-fluid p-3">
        <div class="row g-3">
            <!-- Sidebar for layers control -->
            <div class="col-md-3 sidebar">
                <h4><i class="fas fa-layer-group me-2"></i>Слои</h4>
                <div id="auth-info-banner" class="alert mb-3">
                    <i class="fas fa-lock me-2"></i> Для доступа ко всем слоям и функциям <a href="#" id="login-info-link">авторизуйтесь</a>
                </div>
                <div class="layer-groups">
                    <div class="layer-group">
                        <h5><i class="fas fa-map me-2"></i>Административные границы</h5>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="layer-boundary">
                            <label class="form-check-label" for="layer-boundary">Граница области</label>
                        </div>
                    </div>

                    <div class="layer-group">
                        <h5><i class="fas fa-industry me-2"></i>Промышленные объекты</h5>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="layer-industrial-areas">
                            <label class="form-check-label" for="layer-industrial-areas">Промышленные зоны</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="layer-steel-mills">
                            <label class="form-check-label" for="layer-steel-mills">Металлургические заводы</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="layer-mines">
                            <label class="form-check-label" for="layer-mines">Шахты</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="layer-quarries">
                            <label class="form-check-label" for="layer-quarries">Карьеры</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="layer-chimneys">
                            <label class="form-check-label" for="layer-chimneys">Промышленные трубы</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="layer-kilns">
                            <label class="form-check-label" for="layer-kilns">Печи</label>
                        </div>
                    </div>

                    <div class="layer-group mt-3">
                        <h5><i class="fas fa-road me-2"></i>Инфраструктура</h5>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="layer-railways">
                            <label class="form-check-label" for="layer-railways">Железные дороги</label>
                        </div>
                    </div>

                    <div class="layer-group mt-3">
                        <h5><i class="fas fa-tree me-2"></i>Природные объекты</h5>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="layer-water-polygons">
                            <label class="form-check-label" for="layer-water-polygons">Водоемы</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="layer-water-lines">
                            <label class="form-check-label" for="layer-water-lines">Реки</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="layer-vegetation">
                            <label class="form-check-label" for="layer-vegetation">Растительность</label>
                        </div>
                    </div>
                </div>

                <div class="mt-4">
                    <h4><i class="fas fa-globe me-2"></i>Подложки</h4>
                    <select class="form-select" id="basemap-selector">
                        <option value="osm">OpenStreetMap</option>
                        <option value="satellite">Спутник</option>
                        <option value="topo">Топографическая</option>
                        <option value="boundary">Векторная</option>
                    </select>
                </div>

                <div class="mt-4">
                    <h4><i class="fas fa-tools me-2"></i>Инструменты</h4>
                    <div class="btn-group d-flex" role="group">
                        <button class="btn btn-outline-secondary btn-tool" id="tool-measure">
                            <i class="fas fa-ruler me-1"></i> Измерить
                        </button>
                        <button class="btn btn-outline-secondary btn-tool" id="tool-identify">
                            <i class="fas fa-info-circle me-1"></i> Информация
                        </button>
                    </div>
                    <div class="mt-3">
                        <button class="btn btn-outline-secondary btn-tool w-100" id="tool-screenshot">
                            <i class="fas fa-camera me-1"></i> Снимок карты
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Main map area -->
            <div class="col-md-9">
                <div id="map">
                    <div class="map-overlay scale-info">
                        <i class="fas fa-expand-arrows-alt me-1"></i> <span id="scale-value">Масштаб: 1:1000</span>
                    </div>
                </div>
                <div id="popup" class="ol-popup">
                    <a href="#" id="popup-closer" class="ol-popup-closer"></a>
                    <div id="popup-content"></div>
                </div>
                <div id="mouse-position" class="mouse-position"></div>
            </div>
        </div>
    </main>

    <footer class="py-3 mt-auto">
        <div class="container">
            <div class="row">
                <div class="col-md-8">
                    <p class="mb-0 text-white">© 2025 Геопортал объектов черной металлургии Челябинской области</p>
                </div>
                <div class="col-md-4 text-end">
                    <a href="#" class="text-white me-3"><i class="fab fa-github"></i></a>
                    <a href="#" class="text-white me-3"><i class="fab fa-telegram"></i></a>
                    <a href="#" class="text-white"><i class="fas fa-envelope"></i></a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Modal for About information -->
    <div class="modal fade" id="aboutModal" tabindex="-1" aria-labelledby="aboutModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="aboutModalLabel"><i class="fas fa-info-circle me-2"></i>О проекте</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-md-4 text-center mb-3 mb-md-0">
                                <i class="fas fa-map-marked-alt fa-5x text-primary mb-3"></i>
                                <h4>Интерактивная карта</h4>
                                <p class="small">Визуализация пространственных данных</p>
                            </div>
                            <div class="col-md-8">
                                <p>Геопортал объектов черной металлургии Челябинской области представляет собой интерактивную карту
                                    промышленных объектов региона с возможностью просмотра различных слоев и получения
                                    дополнительной информации.</p>
                                <p>Проект разработан с использованием следующих технологий:</p>
                                <div class="tech-stack d-flex flex-wrap">
                                    <div class="tech-item me-3 mb-2">
                                        <span class="badge bg-secondary"><i class="fas fa-globe me-1"></i>QGIS</span>
                                    </div>
                                    <div class="tech-item me-3 mb-2">
                                        <span class="badge bg-secondary"><i class="fas fa-database me-1"></i>PostgreSQL/PostGIS</span>
                                    </div>
                                    <div class="tech-item me-3 mb-2">
                                        <span class="badge bg-secondary"><i class="fas fa-server me-1"></i>GeoServer</span>
                                    </div>
                                    <div class="tech-item me-3 mb-2">
                                        <span class="badge bg-secondary"><i class="fas fa-map me-1"></i>OpenLayers</span>
                                    </div>
                                    <div class="tech-item me-3 mb-2">
                                        <span class="badge bg-secondary"><i class="fas fa-bolt me-1"></i>FastAPI</span>
                                    </div>
                                    <div class="tech-item me-3 mb-2">
                                        <span class="badge bg-secondary"><i class="fas fa-check-circle me-1"></i>Pydantic</span>
                                    </div>
                                    <div class="tech-item me-3 mb-2">
                                        <span class="badge bg-secondary"><i class="fas fa-table me-1"></i>SQLAlchemy</span>
                                    </div>
                                    <div class="tech-item me-3 mb-2">
                                        <span class="badge bg-secondary"><i class="fab fa-js me-1"></i>JavaScript</span>
                                    </div>
                                    <div class="tech-item me-3 mb-2">
                                        <span class="badge bg-secondary"><i class="fab fa-bootstrap me-1"></i>Bootstrap</span>
                                    </div>
                                    <div class="tech-item me-3 mb-2">
                                        <span class="badge bg-secondary"><i class="fab fa-docker me-1"></i>Docker</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <hr>
                        <div class="author-info text-center">
                            <p>Разработчик: Кривоплясов Илья Николаевич<br>студент 3 курса, группа РСБО-02-22</p>
                            <p>ГИС ИРИ РТУ МИРЭА 2025г.</p>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Закрыть</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for Login -->
    <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="loginModalLabel"><i class="fas fa-user-circle me-2"></i>Авторизация</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <ul class="nav nav-tabs" id="authTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="login-tab" data-bs-toggle="tab" data-bs-target="#login-tab-pane" 
                                    type="button" role="tab" aria-controls="login-tab-pane" aria-selected="true">
                                    <i class="fas fa-sign-in-alt me-1"></i> Вход
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="register-tab" data-bs-toggle="tab" data-bs-target="#register-tab-pane" 
                                    type="button" role="tab" aria-controls="register-tab-pane" aria-selected="false">
                                    <i class="fas fa-user-plus me-1"></i> Регистрация
                            </button>
                        </li>
                    </ul>
                    
                    <div class="tab-content pt-3" id="authTabsContent">
                        <!-- Login Form -->
                        <div class="tab-pane fade show active" id="login-tab-pane" role="tabpanel" aria-labelledby="login-tab" tabindex="0">
                            <form id="login-form">
                                <div class="alert alert-danger d-none" id="login-error"></div>
                                <div class="mb-3">
                                    <label for="login-username" class="form-label">
                                        <i class="fas fa-user me-1"></i> Имя пользователя
                                    </label>
                                    <input type="text" class="form-control" id="login-username" required>
                                </div>
                                <div class="mb-3">
                                    <label for="login-password" class="form-label">
                                        <i class="fas fa-lock me-1"></i> Пароль
                                    </label>
                                    <div class="input-group">
                                        <input type="password" class="form-control" id="login-password" required>
                                        <button class="btn btn-outline-secondary toggle-password" type="button">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="d-grid">
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-sign-in-alt me-1"></i> Войти
                                    </button>
                                </div>
                            </form>
                        </div>
                        
                        <!-- Register Form -->
                        <div class="tab-pane fade" id="register-tab-pane" role="tabpanel" aria-labelledby="register-tab" tabindex="0">
                            <form id="register-form">
                                <div class="alert alert-danger d-none" id="register-error"></div>
                                <div class="mb-3">
                                    <label for="register-username" class="form-label">
                                        <i class="fas fa-user me-1"></i> Имя пользователя
                                    </label>
                                    <input type="text" class="form-control" id="register-username" required>
                                </div>
                                <div class="mb-3">
                                    <label for="register-email" class="form-label">
                                        <i class="fas fa-envelope me-1"></i> Электронная почта
                                    </label>
                                    <input type="email" class="form-control" id="register-email" required>
                                </div>
                                <div class="mb-3">
                                    <label for="register-password" class="form-label">
                                        <i class="fas fa-lock me-1"></i> Пароль
                                    </label>
                                    <div class="input-group">
                                        <input type="password" class="form-control" id="register-password" required>
                                        <button class="btn btn-outline-secondary toggle-password" type="button">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                    <div class="form-text">Пароль должен содержать минимум 8 символов, одну заглавную букву, одну строчную букву и одну цифру.</div>
                                    <div id="password-strength-indicator" class="mt-2">
                                        <div class="d-flex">
                                            <div class="flex-grow-1 me-1">
                                                <div class="progress" style="height: 5px;">
                                                    <div id="password-length-check" class="progress-bar bg-danger" role="progressbar" style="width: 0%"></div>
                                                </div>
                                                <small>Длина (мин. 8)</small>
                                            </div>
                                            <div class="flex-grow-1 me-1">
                                                <div class="progress" style="height: 5px;">
                                                    <div id="password-uppercase-check" class="progress-bar bg-danger" role="progressbar" style="width: 0%"></div>
                                                </div>
                                                <small>Заглавная буква</small>
                                            </div>
                                            <div class="flex-grow-1 me-1">
                                                <div class="progress" style="height: 5px;">
                                                    <div id="password-lowercase-check" class="progress-bar bg-danger" role="progressbar" style="width: 0%"></div>
                                                </div>
                                                <small>Строчная буква</small>
                                            </div>
                                            <div class="flex-grow-1">
                                                <div class="progress" style="height: 5px;">
                                                    <div id="password-digit-check" class="progress-bar bg-danger" role="progressbar" style="width: 0%"></div>
                                                </div>
                                                <small>Цифра</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label for="register-password-confirm" class="form-label">
                                        <i class="fas fa-lock me-1"></i> Подтвердите пароль
                                    </label>
                                    <div class="input-group">
                                        <input type="password" class="form-control" id="register-password-confirm" required>
                                        <button class="btn btn-outline-secondary toggle-password" type="button">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="d-grid">
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-user-plus me-1"></i> Зарегистрироваться
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for Screenshot -->
    <div class="modal fade" id="screenshotModal" tabindex="-1" aria-labelledby="screenshotModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="screenshotModalLabel"><i class="fas fa-camera me-2"></i>Снимок карты</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body text-center">
                    <div class="screenshot-container mb-3">
                        <img id="screenshot-image" class="img-fluid border shadow-sm" src="" alt="Снимок карты">
                    </div>
                    <div class="d-flex justify-content-center">
                        <button id="download-screenshot" class="btn btn-primary">
                            <i class="fas fa-download me-2"></i>Скачать изображение
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="lib/bootstrap/bootstrap.bundle.min.js"></script>
    <script src="lib/ol/ol.js"></script>
    <script type="module" src="js/main.js"></script>
</body>

</html>