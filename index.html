<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Геопортал объектов черной металлургии Челябинской области</title>
    <link rel="stylesheet" href="/lib/bootstrap/bootstrap.min.css">
    <link rel="stylesheet" href="/lib/ol/ol.css">
    <link rel="stylesheet" href="/css/styles.css">
</head>

<body>
    <header class="bg-dark text-white py-3">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1>Геопортал объектов черной металлургии</h1>
                    <p class="lead mb-0">Челябинская область</p>
                </div>
                <div class="col-md-4 text-end">
                    <div id="auth-buttons">
                        <button class="btn btn-outline-light me-2" id="login-btn">Войти</button>
                        <button class="btn btn-outline-light" id="about-btn">О проекте</button>
                    </div>
                    <div id="user-profile" class="d-none">
                        <span class="text-white me-2">Вы вошли как: <strong id="user-display-name"></strong></span>
                        <button class="btn btn-danger btn-sm" id="logout-btn">Выйти</button>
                        <button class="btn btn-outline-light ms-2" id="about-btn-logged">О проекте</button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main class="container-fluid p-0">
        <div class="row g-0">
            <!-- Sidebar for layers control -->
            <div class="col-md-3 sidebar p-3">
                <h4>Слои</h4>
                <div id="auth-info-banner" class="alert alert-warning mb-3">
                    <i class="fas fa-lock me-2"></i> Для доступа ко всем слоям и функциям <a href="#" id="login-info-link">авторизуйтесь</a>
                </div>
                <div class="layer-groups">
                    <div class="layer-group">
                        <h5>Административные границы</h5>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="layer-boundary">
                            <label class="form-check-label" for="layer-boundary">Граница области</label>
                        </div>
                    </div>

                    <div class="layer-group">
                        <h5>Промышленные объекты</h5>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="layer-industrial-areas">
                            <label class="form-check-label" for="layer-industrial-areas">Промышленные зоны</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="layer-steel-mills">
                            <label class="form-check-label" for="layer-steel-mills">Металлургические заводы</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="layer-mines">
                            <label class="form-check-label" for="layer-mines">Шахты</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="layer-quarries">
                            <label class="form-check-label" for="layer-quarries">Карьеры</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="layer-chimneys">
                            <label class="form-check-label" for="layer-chimneys">Промышленные трубы</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="layer-kilns">
                            <label class="form-check-label" for="layer-kilns">Печи</label>
                        </div>
                    </div>

                    <div class="layer-group mt-3">
                        <h5>Инфраструктура</h5>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="layer-railways">
                            <label class="form-check-label" for="layer-railways">Железные дороги</label>
                        </div>
                    </div>

                    <div class="layer-group mt-3">
                        <h5>Природные объекты</h5>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="layer-water-polygons">
                            <label class="form-check-label" for="layer-water-polygons">Водоемы</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="layer-water-lines">
                            <label class="form-check-label" for="layer-water-lines">Реки</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="layer-vegetation">
                            <label class="form-check-label" for="layer-vegetation">Растительность</label>
                        </div>
                    </div>
                </div>

                <div class="mt-4">
                    <h4>Подложки</h4>
                    <select class="form-select" id="basemap-selector">
                        <option value="osm">OpenStreetMap</option>
                        <option value="satellite">Спутник</option>
                        <option value="topo">Топографическая</option>
                        <option value="boundary">Векторная</option>
                    </select>
                </div>

                <div class="mt-4">
                    <h4>Инструменты</h4>
                    <div class="btn-group d-flex" role="group">
                        <button class="btn btn-outline-secondary btn-tool" id="tool-measure">Измерить</button>
                        <button class="btn btn-outline-secondary btn-tool" id="tool-identify">Информация</button>
                    </div>
                </div>
            </div>
            
            <!-- Main map area -->
            <div class="col-md-9">
                <div id="map"></div>
                <div id="popup" class="ol-popup">
                    <a href="#" id="popup-closer" class="ol-popup-closer"></a>
                    <div id="popup-content"></div>
                </div>
                <div id="mouse-position" class="mouse-position"></div>
            </div>
        </div>
    </main>

    <footer class="bg-dark text-white py-3 mt-auto">
        <div class="container text-center">
            <p class="mb-0">© 2025 Геопортал объектов черной металлургии Челябинской области</p>
        </div>
    </footer>

    <!-- Modal for About information -->
    <div class="modal fade" id="aboutModal" tabindex="-1" aria-labelledby="aboutModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="aboutModalLabel">О проекте</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>Геопортал объектов черной металлургии Челябинской области представляет собой интерактивную карту
                        промышленных объектов региона с возможностью просмотра различных слоев и получения
                        дополнительной информации.</p>
                    <p>Проект разработан с использованием следующих технологий:</p>
                    <ul>
                        <li>QGIS - для подготовки геоданных</li>
                        <li>PostgreSQL/PostGIS - для хранения пространственных данных</li>
                        <li>GeoServer - для публикации слоев</li>
                        <li>OpenLayers - для отображения интерактивной карты</li>
                    </ul>
                    <p>Разработчик: Кривоплясов Илья Николаевич, студент 3 курса, группа РСБО-02-22</p>
                    <p>ГИС ИРИ РТУ МИРЭА 2025г.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Закрыть</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for Login -->
    <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="loginModalLabel">Авторизация</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <ul class="nav nav-tabs" id="authTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="login-tab" data-bs-toggle="tab" data-bs-target="#login-tab-pane" 
                                    type="button" role="tab" aria-controls="login-tab-pane" aria-selected="true">Вход</button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="register-tab" data-bs-toggle="tab" data-bs-target="#register-tab-pane" 
                                    type="button" role="tab" aria-controls="register-tab-pane" aria-selected="false">Регистрация</button>
                        </li>
                    </ul>
                    
                    <div class="tab-content pt-3" id="authTabsContent">
                        <!-- Login Form -->
                        <div class="tab-pane fade show active" id="login-tab-pane" role="tabpanel" aria-labelledby="login-tab" tabindex="0">
                            <form id="login-form">
                                <div class="alert alert-danger d-none" id="login-error"></div>
                                <div class="mb-3">
                                    <label for="login-username" class="form-label">Имя пользователя</label>
                                    <input type="text" class="form-control" id="login-username" required>
                                </div>
                                <div class="mb-3">
                                    <label for="login-password" class="form-label">Пароль</label>
                                    <input type="password" class="form-control" id="login-password" required>
                                </div>
                                <div class="d-grid">
                                    <button type="submit" class="btn btn-primary">Войти</button>
                                </div>
                            </form>
                        </div>
                        
                        <!-- Register Form -->
                        <div class="tab-pane fade" id="register-tab-pane" role="tabpanel" aria-labelledby="register-tab" tabindex="0">
                            <form id="register-form">
                                <div class="alert alert-danger d-none" id="register-error"></div>
                                <div class="mb-3">
                                    <label for="register-username" class="form-label">Имя пользователя</label>
                                    <input type="text" class="form-control" id="register-username" required>
                                </div>
                                <div class="mb-3">
                                    <label for="register-email" class="form-label">Электронная почта</label>
                                    <input type="email" class="form-control" id="register-email" required>
                                </div>
                                <div class="mb-3">
                                    <label for="register-password" class="form-label">Пароль</label>
                                    <input type="password" class="form-control" id="register-password" required>
                                </div>
                                <div class="mb-3">
                                    <label for="register-password-confirm" class="form-label">Подтвердите пароль</label>
                                    <input type="password" class="form-control" id="register-password-confirm" required>
                                </div>
                                <div class="d-grid">
                                    <button type="submit" class="btn btn-primary">Зарегистрироваться</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="/lib/bootstrap/bootstrap.bundle.min.js"></script>
    <script src="/lib/ol/ol.js"></script>
    <script type="module" src="/js/main.js"></script>
</body>

</html>